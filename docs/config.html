







<HTML>
<HEAD>
<TITLE>MasqMail - Manual
</TITLE>
</HEAD>
  <BODY TEXT="#000000" LINK="#0000ff" BGCOLOR="#ffffff">
    
    <center>
      <table width="80%">
	<tr><td>
	    <table width="100%" bgcolor="#0000aa" cellspacing=0 cellpadding=0>
<tr>
  <td>
  <a href="manual.html">
    <img width="20" src = "../images/u_arrow.gif" alt = "manual">
  </a>
  </td>
<td align=center width="100%"><font size="6" color = "#ffffff">Configuration</font></td>
<td>
  <a href="./alias.html">
    <img width="20" src = "../images/l_arrow.gif" alt = "Alias Format">
  </a>
</td>
<td>
  <a href="./faq.html">
    <img width="20" src = "../images/r_arrow.gif" alt = "Frequently Asked Questions">
  </a>
</td>
</tr>
</table>


<p>The configuration consists of lines of the form</p>

<i>val</i> = <i>expression</i>

<p>Where <i>val</i> is a variable name and <i>expression</i> a string,
which can be quoted with '"'. If the expression is on multiple lines
or contains characters other than letters, digits or the charcaters
'.', '-', '_', '/', it <em>must</em> be quoted. Unfortunately, you
cannot use quotes inside quotes. (Will be implemented in a later
version.)</p>

<p>Each val has a <i>type</i>, which can be boolean, numeric, string
or list. A boolean variable can be set with one of the values 'on',
'yes', and 'true' or 'off', 'no' and 'false'. List items are separated
with ';'. For some values patterns (like '*','?') can be used. The
spaces before and after the '=' are optional.</p>

<p>Most lists (exceptions: local_hosts, local_nets and
listen_addresses) accept files. These will be recognized by a leading
slash '/'. The contents of these files will be included at the
position of the file name, there can be items or other files before
and after the file entry. The format of the files is different
though, within these files each entry is on another line. (And not
separated by semicolons). This makes it easy to include large lists
which are common in different configuration files, so they do not have
to appear in every configuration file.</p>

<p>Blank lines and lines starting with '#' are ignored.</p>

<h4><font color = "#ff0000">Main Configuration</font></h4>

<b>run_as_user</b>, Type: <i>boolean</i>, default: <i>false</i>

<p>If this is set, masqmail runs with the user id of the user who
invoked it and never changes it. This is for debugging purposes
<em>only</em>. If the user is not root, masqmail will not be able to
listen on a port &lt; 1000 and will not be able to deliver local mail
to others than the user.</p>

<b>use_syslog</b>, Type: <i>boolean</i>, default: <i>false</i>

<p>If this is set, masqmail uses syslogd for logging. It uses facility
<i>MAIL</i>. You still have to set <b>log_dir</b> for debug files.</p>

<b>debug_level</b>, Type: <i>numeric</i>, default: <i>0</i>

<p>Set the debug level. Valid values are 0 to 6, increasing it further
makes no difference. Be careful if you set this as high as 5 or higher,
the logs may very soon fill your hard drive.</p>

<b>mail_dir</b>, Type: <i>string</i>, default: <i>none</i>

<p>The directory where local mail is stored, usually /var/spool/mail.</p>

<b>spool_dir</b>, Type: <i>string</i>, default: <i>none</i>

<p>The directory where masqmail stores its spool files (and later also
other stuff). It <em>must</em> have a subdirectory
<i>input</i>. Masqmail needs read and write permissions for this
directory. I suggest to use /var/spool/masqmail.</p>

<b>log_dir</b>, Type: <i>string</i>, default: <i>none</i>

<p>The directory where masqmail puts its log files, these are
<i>masqmail.log</i> and <i>debug.log</i>. Masqmail needs write
permission.</p>

<b>host_name</b>, Type: <i>string</i>, default: <i>none</i>

<p>This is used in different places: Masqmail identifies itself in the
greeting banner on incoming connections and in the HELO/EHLO command
for outgoing connections with this name, it is used in the Received:
header and to qualify the sender of a locally originating message.</p>

<p>It is <em>not</em> used to find whether an address is local. Use
<b>local_hosts</b> for that.</p>

<b>local_hosts</b>, Type: <i>list</i>, default: <i>none</i>

<p>A semicolon ';' separated list of hostnames which are considered
local. Normally you set it to "localhost;foo;foo.bar.com" if your host
has the fully qualified domain name 'foo.bar.com'.</p>

<b>local_nets</b>, Type: <i>list</i>, default: <i>none</i>

<p>A semicolon ';' separated list of hostnames which are on the
'local' net. Delivery to these hosts is attempted immediately. You can
use patterns with '*', eg. "*.bar.com".</p>

<b>listen_addresses</b>, Type: <i>list</i>, default: <i>none</i>

<p>A semicolon ';' separated list of interfaces on which connections
will be accepted. An interface ist defined by a hostname, optionally
followed by a colon ':' and a number for the port. If this is left out,
port 25 will be used.</p>

<p>You can set this to "localhost:25;foo:25" if your hostname is 'foo'.</p>

<b>do_queue</b>, Type: <i>boolean</i>, default: <i>false</i>

<p>If this is set, mail will not be delivered immediately when
accepted. Same as calling masqmail with the -odq option.</p>

<b>connect_route.&lt;name&gt;</b>, Type: <i>string</i>, default: <i>none</i>

<p>Replace &lt;name&gt; with a name to identify a connection. Set this
to a filename for the special <i>route</i> configuration for that
connection. You will use that name to call masqmail with the -qo option
every time a connection to your ISP is set up.</p>

<p>Example: Your ISP has the name <i>FastNet</i>. Then you write the
following line in the main configuration:</p>

<p><pre>connect_route.FastNet = "/etc/masqmail/fastnet.route"</pre></p>

<p>/etc/masqmail/fastnet.route is the route configuration file, see
below. As soon as a link to FastNet has been set up, you call masqmail
-qoFastNet. Masqmail will then read the specified file and send the
mails.</p>

<b>local_net_route</b>, Type: <i>string</i>, default: <i>none</i>

<p>This is similar to <b>connect_route.&lt;name&gt;</b> but for the
local net. Recipient addresses that are in <b>local_nets</b> will be
routed using this route configuration. Main purpose is to define a
mail server with <b>mail_host</b> in your local network. In simple
environments this can be left unset. If unset, a default route
configuration will be used.</p>

<b>alias_file</b>

<p>Set this to the location of your alias file. If unset, not aliasing
will be done.</p>

<b>online_detect</b>, Type: <i>string</i>, default: <i>none</i>

<p>Defines the method MasqMail uses to detect whether there is
currently an online connection. It can have the values <em>file</em>
or <em>mserver</em>.</p>

<p>When it is set to <em>file</em>, MasqMail first checks for the
existence of <b>online_file</b> (see below) and if it exists, it reads
it. The content of the file should be the name of the current
connection as defined with <b>connect_route.&lt;name&gt;</b> (without
a trailing newline character).</p>

<p>When it is set to <em>mserver</em>, MasqMail connects to the
masqdialer server using the value of <b>mserver_iface</b> and asks it
whether a connection exists and for the name, which should be the name
of the current connection as defined with
<b>connect_route.&lt;name&gt;</b>.</p>

<p>No matter how MasqMail detects the online status, only messages
that are accepted at online time will be delivered using the
connection. The spool still has to be emptied with masqmail -qo
&lt;connection&gt;.</p>

<b>online_file</b>, Type: <i>string</i>, default: <i>none</i>

<p>This is the name of the file checked for when MasqMail determines
whether it is online. The file should only exist when there is
currently a connection. Create it in your ip-up script with eg.</p>

<p><pre>
echo -n &lt;name&gt; &gt; /tmp/connect_route
chmod 0644 /tmp/connect_route
</pre></p>

<p>Do not forget to delete it in your ip-down script.</p>

<b>mserver_iface</b>, Type: <i>string</i>, default: <i>none</i>

<p>The interface the masqdialer server is listening to. Usually this
will be "localhost:224" if mserver is running on the same host as
masqmail. But using this option, you can also let masqmail run on
another host by setting mserver_iface to another hostname,
eg. "foo:224".</p>

<h4><font color = "#ff0000">Route Configuration</font></h4>

<b>mail_host</b>, Type: <i>string</i>, default: <i>none</i>

<p>This is preferably the mail server of your ISP. All outgoing
messages will be sent to this host which will distribute them to their
destinations. If you do not set this mails will be sent
directly. Because the mail server is probably 'near' to you, mail
transfer will be much faster if you use it.</p>

<b>do_correct_helo</b>, Type: <i>boolean</i>, default: <i>false</i>

<p>If this is set, masqmail tries to look up your host name as it
appears on the internet and sends this in the HELO/EHLO command. Some
servers are so picky that they want this. <em>Which is really
crazy. It just does not make any sense to lie about ones own identity,
because it can always be looked up by the server. Nobody should
believe in the name given by HELO/EHLO anyway.</em> If this is not
set, <b>host_name</b> will be used.</p>

<b>allowed_mail_locals</b>, Type: <i>list</i>, default: <i>none(all)</i>

<p>This is a semicolon ';' separated list of local parts which will be
allowed to send mail through this connection. If unset and
<b>not_allowed_mail_locals</b> is also unset, all users are
allowed.</p>

<b>not_allowed_mail_locals</b>, Type: <i>list</i>, default: <i>none</i>

<p>This is a semicolon ';' separated list of local parts which will be
<em>not</em> allowed to send mail through this connection. <em>Local
parts in this list will not be allowed to use this route even if they
are part of <b>allowed_mail_locals</b> (see above).</em></p>

<b>allowed_rcpt_domains</b>, Type: <i>list</i>, default: <i>none(all)</i>

<p>A list of recipient domains where mail will be sent to. This is for
example useful if you use this route configuration when connected to
another LAN via ppp. Patterns containing '?' and '*' can be used.</p>

<b>not_allowed_rcpt_domains</b>, Type: <i>list</i>, default: <i>none</i>

<p>A list of recipient domains where mail will <em>not</em> be sent
to. This is for example useful if you send mail directly (mail_host
ist not set) and you know of hosts that will not accept mail from you
because they use a dialup list (eg. <a
href="http://maps.vix.com/dul/"> maps.vix.com/dul/</a>). If any domain
matches <em>both</em> <b>allowed_rcpt_domains</b> and
<b>not_allowed_rcpt_domains</b>, mail will <em>not</em> be sent to
this domain. Patterns containing '?' and '*' can be used.</p>

<b>set_h_from_domain</b>, Type: <i>string</i>, default: <i>none</i>

<p>Replace the domain part in 'From:' headers with this value. This
may be useful if you use a private, outside unknown address on your
local LAN and want this to be replaced by the domain of the address of
your email addrsss on the internet. <em>Note that this is different to
<b>set_return_path_domain</b>, see below.</em></p>

<b>set_h_reply_to_domain</b>, Type: <i>string</i>, default: <i>none</i>

<p>Same as <b>set_h_from_domain</b>, but for the 'Reply-To' header.</p>

<b>set_return_path_domain</b>, Type: <i>string</i>, default: <i>none</i>

<p>Sets the domain part of the envelope from address. Some hosts check
whether this is the same as the net the connection is coming from. If
not, they reject the mail because they suspect spamming. It should be
a <em>valid</em> address, because some mail servers also check
that. You can also use this to set it to your usual address on the
internet and put a local address only known on your LAN in the
configuration of your mailer. <em>Only the <em>domain</em> part will
be changed, the local part remains unchanged. Use
<b>map_return_path_addresses</b> for rewriting local parts</em>.</p>

<b>map_h_from_addresses</b>, Type: <i>list</i>, default: <i>none</i>

<p>This is similar to <b>set_h_from_domain</b>, but more flexible. Set
this to a list which maps local parts to a full RFC 822 compliant
email address, the local parts (the <em>keys</em>) are separated from
the addresses (the <em>values</em>) by colons (':').</p>

<p>Example:</p>

<p><pre>
map_h_from_addresses =
"john: John Smith &lt;jsmith@mail.academic.edu&gt;;
charlie: Charlie Miller &lt;cmiller@mx.commercial.com&gt;"
</pre></p>

<b>map_h_reply_to_addresses</b>, Type: <i>list</i>, default: <i>none</i>

<p>Same as <b>map_h_from_addresses</b>, but for the 'Reply-To:' header.</p>

<b>map_return_path_addresses</b>, Type: <i>list</i>, default: <i>none</i>

<p>This is similar to <b>set_return_path_domain</b>, but more
flexible. Set this to a list which maps local parts to a full RFC 821
compliant email address, the local parts (the <em>keys</em>) are
separated from the addresses (the <em>values</em>) by colons
(':'). Note that this option takes <em>RFC 821</em> addresses
while <b>map_h_from_addresses</b> takes <em>RFC 822</em> addresses. The
most important difference is that RFC 821 addresses have no full
name.</p>

<p>Example:</p>
<p><pre>
map_return_path_addresses =
"john: &lt;jsmith@mail.academic.edu&gt;;
charlie: &lt;cmiller@mx.commercial.com&gt;"
</pre></p>

<b>expand_h_sender_domain</b>, Type: <i>boolean</i>, default: <i>true</i>

<p>This sets the domain of the sender address as given by the Sender:
header to the same domain as in the envelope return path address
(which can be set by either <b>set_return_path_domain</b> or
<b>map_return_path_addresses</b>). This is for mail clients
(eg. Microsoft Outlook) which use this address as the sender
address. <em>Though they should use the From: address, see RFC
821. </em>If <i>fetchmail</i> encounters an unqualified Sender:
address, it will be expanded to the domain of the pop server, which is
almost never correct. </p>
	  </td></tr>
    
	<tr><td>
	    <p>
	    <hr>
	    <address><a href = "mailto:kurth@innominate.de">Oliver Kurth</a></address>
	    Last modified: Mon Feb 28 20:24:54 CET 2000
	    <br>
	    This page was created using <a href="http://www.freddyfrog.com/hacks/genpage/">Genpage</a> - Version: 1.0.6
	  </p>
    
      </table>
    </center>

  </BODY>
</HEAD>
  
