simple installation instructions, see docs/install.html for more.

To compile MasqMail you need glib 1.2 (http://www.gtk.org).

You need a user and a group for masqmail to run, I suggest user
'mail' and group 'trusted'. Say:

groupadd -g 42 trusted
useradd -u 42 -g 42 -d / -s /bin/sh -c "Mail Transfer Agent" mail

If you use other names than 'mail' and 'trusted' use the options
described below for configure. The 42 is just a suggestion, you can
use any number you like, but preferably one < 100. It does not have
to be the same for the user 'mail' and the group 'trusted'.

Then do:

./configure
make
make install

Debian:
If you compile for Debian, do the configure with at least these options,
this makes it compatible with the official debian package:
./configure --with-liblockfile --with-group=mail
you do not need the group 'trusted', use 'mail' instead.

You can also build your own Debian package with dpkg-buildpackage -rfakeroot.

SuSE/Redhat:
There are spec files for rpm creation in suse/ or redhat/. You may have to adjust these files.


Sorry, but after that you are not yet finished. For instruction on how
to deliver mail using a connection to your ISP see
docs/install.html. It is probably a good idea to copy the files
docs/*.html to a directory where you can access them with a browser.

additional options for configure:
---------------------------------

--with-user=USER sets the user as which MasqMail will run. Default is
'mail'. USER has to exist before you 'make install'.

--with-group=GROUP sets the group as which MasqMail will run. Default
is 'trusted'. GROUP has to exist before you 'make install'.

--with-logdir=LOGDIR sets the directory where MasqMail stores its log
files. It will be created if it does not exist. Default is /var/masqmail/.

--with-spooldir=SPOOLDIR sets the directory where MasqMail stores its
spool files. It will be created if it does not exist. Default is
/var/spool/masqmail/.

--with-confdir=CONFDIR sets the default configuration directory to
CONFDIR, in case you prefer another location than /etc/masqmail/.

--enable-auth enables ESMTP AUTH support (disabled by default)

--disable-pop3 disables pop3 support (enabled by default)

--enable-maildir enables qmail style Maildir support (disabled by default)

--enable-ident enable RFC 1413 support. If you have the libident
dynamic library installed, this will be linked, otherwise it will be
statically linked using the sources included in the package.

--disable-resolver disable resolver support. Without the resolver functions,
masqmail uses only gethostbyname() to resolve DNS names, and you cannot send
mail without a smart host. Not recommended. You save 3K at most.

--disable-smtp-server disable SMTP server support. You may want this if you do
not need masqmail to listen. In this case, you cannot use masqmail as a smart
host for other hosts on your LAN, you cannot use mail clients that send SMTP,
you cannot even use pine. In short, use of this option is discouraged unless
your resources are extremely limited.

--enable-mserver enable online detection by connecting to the mserver
(masqdialer system).

--with-libcryto instead of using the md5 and hmac functions within the package,
link dynamically with libcrypto. This applies only if you have pop3 or SMTP
AUTH enabled. Makes only sense if your resources are limited and you have
libcrypto installed. Untested.

--with-glib-static link with glib statically. This makes the binary larger
by around 30K (i386 architecture), but if masqmail is the only binary using
glib, you save some space in total, because you do not need the shared glib
library installed.

--disable-debug disable debugging, setting it on by command line or configuration
has no effect. Strongly discouraged, since you miss valuable information if something
goes wrong. You save 6K.

BTW, to get 3K of space, call
strip --remove-section=.comment --remove-section=.note --strip-unneeded src/masqmail

after make install:
-------------------

You can also use these instructions to omit 'make install' if you do
not want to use it.

Check that 'make install' worked correctly. The following command:

ls -ld /usr/sbin/masqmail /var/masqmail/ /var/spool/masqmail /var/spool/masqmail/input

should give output similar to

-rwsr-xr-x   1 root     root        86955 Oct 14 14:27 /usr/sbin/masqmail
drwxr-xr-x   2 mail     trusted      1024 Oct 14 14:29 /var/masqmail/
drwxr-xr-x   3 mail     trusted      1024 Oct 14 14:27 /var/spool/masqmail
drwxr-xr-x   2 mail     trusted      1024 Oct 14 18:32 /var/spool/masqmail/input
drwxr-xr-x   2 mail     trusted      1024 Oct 14 18:32 /var/spool/masqmail/lock
drwxr-xr-x   2 mail     trusted      1024 Oct 14 18:32 /var/spool/masqmail/popuidl

(important is the set-user-id bit for /usr/sbin/masqmail and the
ownership of all items).

Use the example configuration files in examples/ to edit your own. The
main configuration should go to /etc/masqmail.conf. I recommend to
make a directory /etc/masqmail for the *.route amd *.get files.

The default destination for the executable 'masqmail' is
/usr/sbin. Check that it has the set user id bit set. (chmod u+s
/usr/sbin/masqmail does no harm in any case).

If you want to replace sendmail, move your old sendmail binary to
another name and make a symbolic link /usr/sbin/sendmail ->
/usr/sbin/masqmail.


